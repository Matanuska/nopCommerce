@model Nop.Plugin.Tax.FixedOrByCountryStateZip.Models.ConfigurationModel

@{
    Layout = "_ConfigurePlugin";

    var showTour = ViewBag.showtour ?? false;
    if (showTour)
    {
        Html.AppendCssFileParts("~/lib_npm/shepherd.js/css/shepherd.css");
        Html.AppendScriptParts("~/lib_npm/shepherd.js/js/shepherd.min.js");
        Html.AppendScriptParts("~/js/admintour/admin.tour.localresources.provider.js");
        Html.AppendScriptParts("~/js/admintour/admin.tour.taxmanual.js");

        <script asp-location="Footer">
            var localized_data = {
                Back: "@T("Admin.ConfigurationSteps.Back")",
                Next: "@T("Admin.ConfigurationSteps.Next")",
                Done: "@T("Admin.ConfigurationSteps.Done")",

                TaxManualSwitchTitle: "@T("Admin.ConfigurationSteps.TaxManual.Switch.Title")",
                TaxManualSwitchText: "@T("Admin.ConfigurationSteps.TaxManual.Switch.Text")",

                TaxManualFixedTitle: "@T("Admin.ConfigurationSteps.TaxManual.Fixed.Title")",
                TaxManualFixedText: "@T("Admin.ConfigurationSteps.TaxManual.Fixed.Text")",

                TaxManualByCountryTitle: "@T("Admin.ConfigurationSteps.TaxManual.ByCountry.Title")",
                TaxManualByCountryText: "@T("Admin.ConfigurationSteps.TaxManual.ByCountry.Text")",

                TaxManualCategoriesTitle: "@T("Admin.ConfigurationSteps.TaxManual.Categories.Title")",
                TaxManualCategoriesText: "@T("Admin.ConfigurationSteps.TaxManual.Categories.Text")",

                TaxManualEditTitle: "@T("Admin.ConfigurationSteps.TaxManual.Edit.Title")",
                TaxManualEditText: "@T("Admin.ConfigurationSteps.TaxManual.Edit.Text")",
            };

            LocalResourcesProvider.init(localized_data);
        </script>
    }
}

<div class="form-group row">
    <div class="col-md-12">
        <div class="onoffswitch">
            <input type="checkbox" name="onoffswitch" class="onoffswitch-checkbox" id="advanced-settings-mode" checked="@Model.CountryStateZipEnabled">
            <label class="onoffswitch-label" for="advanced-settings-mode">
                <span class="onoffswitch-inner"
                      data-locale-basic="@T("Plugins.Tax.FixedOrByCountryStateZip.Fixed")"
                      data-locale-advanced="@T("Plugins.Tax.FixedOrByCountryStateZip.TaxByCountryStateZip")"></span>
                <span class="onoffswitch-switch"></span>
            </label>
        </div>
    </div>
</div>
<script>
    function checkAdvancedSettingsMode(advanced) {
        if (advanced) {
            $("body").addClass("advanced-settings-mode");
            $("body").removeClass("basic-settings-mode");
        } else {
            $("body").removeClass("advanced-settings-mode");
            $("body").addClass("basic-settings-mode");
        }
    }
    checkAdvancedSettingsMode($("#advanced-settings-mode").is(':checked'));
    $(document).ready(function() {
        $("#advanced-settings-mode").click(function() {
            checkAdvancedSettingsMode($(this).is(':checked'));
            $.ajax({
                cache: false,
                url: "@Url.Action("SaveMode", "FixedOrByCountryStateZip")",
                type: "POST",
                data: {
                    value: $(this).is(':checked')
                },
                dataType: "json",
                error: function (jqXHR, textStatus, errorThrown) {
                    $("#saveModeAlert").click();
                }
            });
            ensureDataTablesRendered();
        });
    });
</script>
<nop-alert asp-alert-id="saveModeAlert" asp-alert-message="@T("Admin.Common.Alert.Save.Error")" />

@await Html.PartialAsync("~/Plugins/Tax.FixedOrByCountryStateZip/Views/_FixedRate.cshtml")
@await Html.PartialAsync("~/Plugins/Tax.FixedOrByCountryStateZip/Views/_CountryStateZip.cshtml", Model)